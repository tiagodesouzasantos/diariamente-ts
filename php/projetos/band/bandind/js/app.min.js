angular.module("bandEdi",["ngMaterial","ngAnimate","ngSanitize","ui.router","gridster","ui.carousel","chart.js","menu","home","edi","bandApiService","initial","dbServer","mapsService","timeService","textService","text","recoverPass","meusDados","tivit"]).config(["$mdThemingProvider","$stateProvider","$urlRouterProvider","$mdDateLocaleProvider",function(e,t,o,r){e.theme("default").primaryPalette("light-blue").accentPalette("light-blue"),t.state("initial",{url:"/initial",views:{"content@":{templateUrl:"modules/initial/index.html",controller:"initialController as initial"}}}),t.state("recoverpass",{url:"/recoverpass/:recoverpass",views:{"content@":{templateUrl:"modules/recoverpass/index.html",controller:"recoverPassController as recoverPass"}}}).state("menu",{abstract:!0,views:{"content@":{templateUrl:"modules/menu/index.html",controller:"menuController as menu"}}}).state("cadedi",{parent:"menu",url:"/cadedi",views:{"main@menu":{templateUrl:"modules/cadedi/index.html",controller:"cadEdiController as cadEdiCtrl"}}}).state("home",{parent:"menu",url:"/home",views:{"main@menu":{templateUrl:"modules/home/index.html",controller:"homeController as homeCtrl"}}}).state("meusDados",{parent:"menu",url:"/meusDados",views:{"main@menu":{templateUrl:"modules/meusDados/index.html",controller:"meusDadosController as meusDados"}}}),o.otherwise("initial"),r.formatDate=function(e){return void 0===e?"":moment(e).format("DD/MM/YYYY")},r.parseDate=function(e){var t=moment(e,"DD/MM/YYYY",!0);return t.isValid()?t.toDate():new Date(NaN)},r.months=["janeiro","fereveiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],r.shortMonths=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],r.shortDays=["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]}]).run(["$rootScope","$state","session",function(e,t,n){var a=["home","menu","meusDados","cadEdi"];e.$on("$locationChangeSuccess",function(e,t,o){for(var r in a)if(-1<t.indexOf(a[r])){n.valideSession(a[r]);break}})}]),angular.module("dbServer",[]),angular.module("mapsService",[]),angular.module("sessionService",[]),angular.module("timeService",[]),angular.module("textService",[]),angular.module("menu",[]),angular.module("admin",[]),angular.module("instrutor",[]),angular.module("text",[]),angular.module("tivit",[]),angular.module("bandApiService",[]),angular.module("initial",[]),angular.module("meusDados",[]),angular.module("treinamento",[]),angular.module("recoverPass",[]),angular.module("edi",["dbServer"]),angular.module("home",["dbServer"]),angular.module("initial").controller("initialController",["$scope","$timeout","$state","$rootScope","initialService","session","dialogService","$http","$q","$mdDialog","msgsService",function(o,e,t,r,n,a,i,s,c,u,l){o.init=function(){console.log("%c Que coisa feia inspecionando o app né! ","background: #222; color: #bada55");try{a.getData("tokenData");t.go("home")}catch(e){t.go("initial")}},o.submit=function(){r.showLoading=!0,n.login(o.login).then(function(e){console.log("authUsuarioResult",e),r.showLoading=!1,t.go("home")}).catch(function(e){r.showLoading=!1;var t={title:"Problemas!",content:e,buttonOk:"Ok"};i.confirm(t)})},o.openDialog=function(e){o.login=null;return u.show({controller:["copiaScope",function(e){return e}],controllerAs:"initial",locals:{copiaScope:o},templateUrl:{rsenha:"modules/initial/recuperar-senha.html",cadastre:"modules/initial/cadastre-se.html"}[e],clickOutsideToClose:!0})},o.closeModal=function(){u.hide()},o.getUserDataByCpf=function(){o.errorMsg=null,n.getRhUsuario(o.login).then(function(e){o.login=e.usuarioRh,o.errorMsg=e.errorMsg}).catch(function(e){var t={title:"Algo aconteceu!",content:e,buttonOk:"Ok"};i.confirm(t)})},o.saveNewUser=function(){o.progress=!0,n.saveNewUser(o.login).then(function(e){o.progress=!1;var t={title:"Deu certo!",content:e,buttonOk:"Ok"};i.confirm(t)}).catch(function(e){o.errorMsg=e;var t={title:"Algo aconteceu!",content:saveResult,buttonOk:"Ok"};i.confirm(t)})},o.recoverPass=function(){o.progress=!0,n.recoverPass(o.login).then(function(e){var t={title:"Deu certo!",content:e,buttonOk:"Ok"};i.confirm(t),o.progress=!1}).catch(function(e){var t={title:"Problemas!",content:e,buttonOk:"Ok"};i.confirm(t),o.progress=!1})}}]),angular.module("initial").service("initialService",["$q","$http","db","msgsService","auth","api",function(n,e,t,a,o,i){return{validaUsuario:function(e){var t=n.defer();if(null!=e||null!=e)t.resolve(e);else{var o={title:"Problemas!",content:a.getMsg("usuario",1),buttonOk:"Ok"};t.reject(o)}return t.promise},login:function(e){var t=n.defer();return e.acao="auth",e.modulo="login",o.login(e).then(function(e){t.resolve(e)}).catch(function(e){t.reject(e)}),t.promise},saveNewUser:function(e){var t=n.defer();return i.post("usuarios",e).then(function(e){e.data.criado?t.resolve(a.getMsg("app",1)):t.reject(a.getMsg("app",3))}).catch(function(e){t.reject(e)}),t.promise},getRhUsuario:function(e){var r=n.defer();return i.show("rhusuarios",e.cpf).then(function(e){var t,o=e.data;t=o.usuarioExiste?{errorMsg:a.getMsg("usuario",2),nome:null}:null==o.usuarioRh?{errorMsg:a.getMsg("usuario",4),nome:null}:{errorMsg:"",usuarioRh:o.usuarioRh},r.resolve(t)}).catch(function(e){r.reject(e)}),r.promise},recoverPass:function(e){var t=n.defer();return i.post("recoverpass",e).then(function(e){t.resolve(a.getMsg("app",11))}).catch(function(e){t.reject(e)}),t.promise}}}]),angular.module("recoverPass").controller("recoverPassController",["$scope","$state","recoverPassService","dialogService","$stateParams",function(o,r,t,n,a){o.init=function(){console.log("%c Que coisa feia inspecionando o app né! ","background: #222; color: #bada55"),o.authToken(),o.progress=!1},o.authToken=function(){var e={hash:a.recoverpass};t.getToken(e).then(function(e){o.loadToken=e}).catch(function(e){var t={title:"Problemas!",content:e,buttonOk:"Ok"};n.confirm(t).then(function(){r.go("initial")})})},o.updatePass=function(){o.progress=!0,o.loadToken.usuario.senha=o.login.senha,t.updatePass(o.loadToken).then(function(e){o.progress=!1;var t={title:"Deu certo!",content:e,buttonOk:"Ok"};n.confirm(t).then(function(){r.go("initial")})}).catch(function(e){o.progress=!1;var t={title:"Problemas!",content:e,buttonOk:"Ok"};n.confirm(t).then(function(){r.go("initial")})})}}]),angular.module("recoverPass").service("recoverPassService",["$q","$http","db","msgsService","api",function(r,e,t,n,a){return{getToken:function(e){var t=r.defer();return a.show("recoverpass",e.hash).then(function(e){console.log("apiResult",e.data),t.resolve(e.data)}).catch(function(e){console.log("apiError",e),t.reject(e)}),t.promise},updatePass:function(e){var o=r.defer();return a.put("recoverpass",e.usuario,e.hashRecoverPass.id).then(function(e){var t=e.data;t.atualizado&&t.hashRemovida&&o.resolve(n.getMsg("app",1))}).catch(function(e){console.log("apiError",e),o.reject(e)}),o.promise}}}]),angular.module("edi").controller("cadEdiController",["$filter","$element","$state","$scope","text","cadEdiService","dialogService","$rootScope","session","$mdDialog","time","msgsService","dateService","$q",function(e,t,o,r,n,a,i,s,c,u,l,d,g,m){var v=this;v.edi={},t.find("input").on("keydown",function(e){e.stopPropagation()}),v.init=function(){v.getDadosIniciais()},v.getDadosIniciais=function(){s.showLoading=!0,a.listaInicial().then(function(e){v.listaOcorrenciasTivit=e.listaOcorrenciasTivit,v.transportadoras=e.listaTransp,s.showLoading=!1}).catch(function(e){i.alert(e),s.showLoading=!1})},v.getDadosChaveAcesso=function(){v.edi.nfe=a.extractDataFromChaveAcesso(v.edi.nfe)},v.saveEdi=function(){s.showLoading=!0;var e=JSON.parse(c.getData("authData"));v.edi.user=e.user.id,a.saveEdi(v.edi).then(function(e){s.showLoading=!1,o.go("home")}).catch(function(e){i.alert(e),s.showLoading=!1})},v.setTranspRazao=function(){var e=v.edi.nfe.cgcTransp.razao_social_transp;v.edi.nfe.razaoSocialTransp=n.textFixedSize(e,40," ")}}]),angular.module("edi").service("cadEdiService",["$q","$http","db","session","$timeout","dateService","msgsService",function(r,e,n,t,o,a,i){return{extractDataFromChaveAcesso:function(e){return{cgc:e.chaveacesso.substr(6,14),serie:e.chaveacesso.substr(22,3),numero:e.chaveacesso.substr(26,8),chaveacesso:e.chaveacesso,razaoSocialTransp:e.razaoSocialTransp,cgcTransp:e.cgcTransp}},saveEdi:function(e){var t=r.defer(),o=angular.copy(e);return o.dtOco=a.formatDateDB(o.dtOco),n.dbActions("save",o,"edi").then(function(e){t.resolve(e)}).catch(function(e){t.reject(i.getMsg("app",3))}),t.promise},listaInicial:function(){var t=r.defer();return n.dbActions("lista",[],"edi").then(function(e){t.resolve(e)}).catch(function(e){t.reject(i.getMsg("app",3))}),t.promise}}}]),angular.module("home").controller("homeController",["$state","$scope","text","homeService","dialogService","$rootScope","session","$mdDialog","time","msgsService","dateService","$q","tivitFileService",function(e,t,n,a,o,r,i,s,c,u,l,d,g){var m=this;m.init=function(){},m.loadInicial=function(){r.showLoading=!0,a.listaInicial().then(function(e){m.ocorrencias=e.listaOcorrenciasEdi,m.listaOcorrenciasTivit=e.listaOcorrenciasTivit,r.showLoading=!1}).catch(function(e){o.alert(e),r.showLoading=!1})},m.openNewOco=function(e){m.edi=e,m.dialog("novo")},m.listOcoEDI=function(e){m.listaOcorrencia=e,m.dialog("lista")},m.dialog=function(e){return s.show({controller:["copiaScope",function(e){return e}],controllerAs:"homeCtrl",locals:{copiaScope:m},templateUrl:{lista:"modules/home/lista-ocorrencias.html",novo:"modules/home/nova-ocorrencia.html"}[e],clickOutsideToClose:!0})},m.deletaOco=function(e){a.deleteOco(e).then(function(e){m.closeModal(),m.init()}).catch(function(e){console.log("deleteError",e),o.alert(e)})},m.closeModal=function(){m.ocor=null,s.hide()},m.findOcorrenciaTivit=function(e){var t=a.findOcorrenciaTivitById(m.listaOcorrenciasTivit,e);return t.cod+" - "+t.desc_ocorrencias},m.gerarEdi=function(e,t){t.ocorr_data=a.findOcorrenciaTivitById(m.listaOcorrenciasTivit,t.fk_cod_oco_tivit);var o=g.getContentTivit(e,t),r=new Date;n.saveTxtFile("OCOBAN"+r.getTime()+".txt",o)},m.gerarEdiTodos=function(e){var t=new Date;t=t.getTime();for(var o=0;o<e.ocorrencias.length;o++){e.ocorrencias[o].ocorr_data=a.findOcorrenciaTivitById(m.listaOcorrenciasTivit,e.ocorrencias[o].fk_cod_oco_tivit);var r=g.getContentTivit(e,e.ocorrencias[o]);n.saveTxtFile("OCOBAN"+t+".txt",r),t=1*t+1}},m.saveOcor=function(){var e=JSON.parse(i.getData("authData"));m.progress=!0,m.ocor.edi=m.edi,m.ocor.user=e.user.id,a.saveOco(m.ocor).then(function(e){m.progress=!1,m.init(),setTimeout(function(){m.closeModal(),m.ocor=null},500)}).catch(function(e){m.progress=!1,o.alert(e)})}}]),angular.module("home").service("homeService",["$q","$http","db","session","$timeout","dateService","msgsService",function(r,e,n,t,o,a,i){return{listaInicial:function(){var t=r.defer();return n.dbActions("listaEdiOco",[],"edi").then(function(e){t.resolve(e)}).catch(function(e){t.reject(i.getMsg("app",3))}),t.promise},findOcorrenciaTivitById:function(e,t){for(var o=0;o<e.length;o++)if(e[o].id==t)return e[o]},saveOco:function(e){var t=r.defer(),o=angular.copy(e);return o.dtOco=a.formatDateDB(e.dtOco),n.dbActions("saveOcoEdi",o,"edi").then(function(e){t.resolve(e)}).catch(function(e){t.reject(i.getMsg("app",3))}),t.promise},deleteOco:function(e){var t=r.defer();return n.dbActions("delete",e,"edi").then(function(e){console.log("deleteOcorResult",e),0==e.delete.length?t.resolve(e):t.reject(i.getMsg("app",3))}).catch(function(e){t.reject(i.getMsg("app",3))}),t.promise}}}]),angular.module("tivit").service("tivitFileService",["$q","$http","db","session","$timeout","dateService","text",function(e,t,o,r,n,a,s){return{getContentTivit:function(e,t){return this.getUnb()+"\r\n"+this.getUnh()+"\r\n"+this.getTra(e,t)+"\r\n"+this.getOen(e,t)},getUnb:function(){var e=[],t="",o=a.formatDateTimeDB(new Date);o=o.split(" "),date=o[0].split("-"),time=o[1].split(":"),e[0]="000",e[1]="BANDEIRANTES LOGISTICA INTEGRADA   ",e[2]="TITAN PNEUS                        ",e[3]=date[2]+date[1]+date[0].substring(2,4),e[4]=time[0]+time[1],e[5]="OCO"+date[2]+date[1]+e[4]+"0",e[6]="                         ";for(var r=0;r<e.length;r++)t+=e[r];return t.substring(0,120)},getUnh:function(){var e=[],t="",o=a.formatDateTimeDB(new Date);o=o.split(" "),date=o[0].split("-"),time=o[1].split(":"),e[0]="340",e[1]="OCORR"+date[2]+date[1]+time[0]+time[1]+"0",e[2]="                                                                                                       ";for(var r=0;r<e.length;r++)t+=e[r];return t.substring(0,120)},getTra:function(e,t){var o=[],r="";o[0]="341",o[1]=s.textFixedSize(e.cgc_transp,14,"0",!0),o[2]=s.textFixedSize(e.razao_social_transp,40," "),o[3]="                                                               ";for(var n=0;n<o.length;n++)r+=o[n];return r.substring(0,120)},getOen:function(e,t){var o=[],r="",n=t.dt_oco.split("-").reverse().join(""),a=t.hr_oco.split(":").join("");o[0]="342",o[1]=s.textFixedSize(e.cgc_emissor,14,"0",!0),o[2]=s.textFixedSize(1*e.serie_nfe+"",3," "),o[3]=s.textFixedSize(e.numero_nfe,8,"0",!0),o[4]=s.textFixedSize(t.ocorr_data.cod,2,"0",!0),o[5]=s.textFixedSize(n,8,"0",!0),o[6]=s.textFixedSize(a,4,"0",!0),o[7]="00",o[8]="                                                                      ",o[9]="0000",o[10]="  ";for(var i=0;i<o.length;i++)r+=o[i];return r}}}]),angular.module("meusDados").controller("meusDadosController",["$scope","meusDadosService","dialogService","session","$mdDialog","msgsService","$state",function(r,e,n,t,o,a,i){r.init=function(){var e=JSON.parse(t.getData("authData"));r.login=e.user},r.save=function(){r.progress=!0,e.save(r.login).then(function(e){r.progress=!1,r.dialogMsg("Deu certo!",e)}).catch(function(e){r.progress=!1,r.dialogMsg("Problemas!",e)})},r.dialogMsg=function(e,t){var o={title:e,content:a.getMsg(t.module,t.msg),buttonOk:"Ok"};n.confirm(o).then(function(){i.go("home")}).catch(function(){r.init()})}}]),angular.module("meusDados").service("meusDadosService",["$q","$http","db","session",function(r,e,n,t){return{save:function(e){var t=r.defer(),o={data:e,busca:"updateMyData"};return n.dbActions("usuarioAd",o,"bandAdManage").then(function(e){null==e.success?t.reject(e.error):t.resolve(e.success)}).catch(function(e){t.reject(e)}),t.promise}}}]),angular.module("menu").controller("menuController",["$mdBottomSheet","$scope","$mdSidenav","$log","$state","$rootScope","session",function(e,t,o,r,n,a,i){t.init=function(){var e=JSON.parse(i.getData("authData"));t.user=e.user},t.close=function(e){o(e).close().then(function(){r.debug("close LEFT is done")}).catch(function(e){console.log(e)})},t.toogleSideNav=function(e){o(e).toggle(),setTimeout(function(){t.$broadcast("reCalcViewDimensions")},1)},t.goto=function(e){"exit"==e&&(sessionStorage.clear(),n.go("initial")),n.go(e),t.close("left")}}]),angular.module("admin").controller("adminController",["$state","$scope","session",function(e,t,o){t.init=function(){t.maxDate=new Date,t.inicial=new Date,t.final=new Date}}]),angular.module("admin").service("adminService",["$q","$http","db","session","$timeout",function(e,t,o,r,n){return{admin:function(){return"oi"}}}]),angular.module("dbServer").service("db",["$q","$http","appUrls","errorRequestService",function(c,u,l,d){return{dbActions:function(e,t,o,r){var n={acao:e,param:t,modulo:o},a=3e4;null==r&&null==r||(a=r);var i={url:l.getUrl("app"),data:n,method:"post",timeout:a},s=c.defer();return u(i).then(function(e){responseData=e.data,null!=responseData?responseData.length<1?s.reject("sem dados"):s.resolve(responseData):s.reject("sem dados")},function(e){console.log("db-error",e),s.reject(d.getMsg(e.status))}),s.promise}}}]),angular.module("bandEdi").service("appUrls",["session",function(e){return{getEnv:function(){var e=window.location.hostname.split("."),t=e[0];return"bandeiranteslog"==e[1]&&(t=e[0]+"."+e[1]),{localhost:"dev",172:"dev",dev:"dev",web:"web.interno","web.bandeiranteslog":"web.externo"}[t]},getUrl:function(e){return{dev:"http://localhost:8013/api/v1/","web.interno":"http://web.new.band/ediband/api/v1/","web.externo":"http://web.bandeiranteslog.com.br/ediband/api/v1/"}[this.getEnv()]+{auth:"auth/login",recoverpass:"recoverpass",usuarios:"usuarios",rhusuarios:"rhusuarios"}[e]}}}]),angular.module("bandEdi").service("dialogService",["$mdDialog","$rootScope","$q",function(r,e,n){return{alert:function(e){r.show(r.alert().clickOutsideToClose(!0).title("Mensagem").textContent(e).ok("Ok"))},confirm:function(e){var t,o=n.defer();return null!=e.buttonCancel?(t=r.confirm()).cancel(e.buttonCancel):t=r.alert(),t.title(e.title).textContent(e.content).ariaLabel(e.label).ok(e.buttonOk),r.show(t).then(function(){o.resolve(!0)},function(){o.reject(!1)}),o.promise},loading:function(e){"hide"!=e?r.show({template:'<div id="loading"><div class="contain-animation"><div class="contain-bear"><img class="prints" src="img/loading/pawprints.svg" alt="Bear Prints" /><span class="cover"></span></div></div></div>',parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:!1,escapeToClose:!1}):r.hide()},openNewWindow:function(e){window.open(e,"_blank","location=yes,scrollbars=yes,status=yes")}}}]),angular.module("bandEdi").service("errorRequestService",["msgsService",function(t){return{getMsg:function(e){switch(e){case 408:return t.getMsg("app","2");default:return t.getMsg("app","3")}}}}]),angular.module("bandEdi").service("msgsService",[function(){return{getIdioma:function(){var e=sessionStorage.getItem("idioma");return null!=e&&null!=e||(e="portugues"),e},getMsg:function(e,t){return{portugues:{usuario:{1:"Usuário ou senha incorretos, por favor tente novamente!",2:"Usuário já cadastrado!",3:"Usuário removido!",4:"Usuário não possui acesso!",5:"Usuário ainda não está cadastrado, realize seu cadastro!",6:"Token invalido, por favor solicite uma nova recuperação de senha!"},app:{1:"Dados salvos com sucesso!",2:"Problemas de conexão com a internet. Por favor, tente novamente mais tarde!",3:"Ocorreu um erro inesperado. Por favor, tente novamente ou contate nosso suporte!",4:"Por favor, aguarde...",5:"Dados de sessão corrompidos. Por favor, faça o login novamente!",6:"Preencha todos os campos corretamente!",7:"Tipo de arquivo inválido!",8:"Não foram encontrados dados para os filtros selecionados!",10:"Nenhum dado encontrado!",11:"E-mail enviado com sucesso!"},"avaliacao-reacao":{1:"Obrigado por contribuir com sua opinião. A partir de agora você já está habilitado a fazer a avaliação!",2:"Você já envio suas opinões para esse treinamento!"}},ingles:{usuario:{1:"Incorrect CPF or password, please try again!"},app:{1:"Data saved successfully!",2:"Problems connecting to the internet. Please try again later!",3:"An unexpected error has occurred. Please try again or contact our support!",4:"Please wait...",5:"Session data corrupted. Please, login again!",6:"Complete all the fields correctly!",7:"Invalid file type!",8:"No data was found for the selected filters!",10:"No data found, please try again later!"}},espanhol:{usuario:{1:"CPF o contraseña incorrecta, por favor inténtelo de nuevo!"},app:{1:"Datos guardados con éxito!",2:"Problemas de conexión a Internet. Por favor, inténtelo de nuevo más tarde!",3:"Se ha producido un error inesperado. Por favor, inténtelo de nuevo o contacte nuestro soporte!",4:"Por favor, espere ...",5:"Datos de sesión dañados. Por favor, inicie sesión de nuevo!",6:"Rellena todos los campos correctamente!",7:"Tipo de archivo no válido!",8:"No se han asignado datos a los filtros seleccionados!",10:"Ningún dato encontrado, vuelva a intentarlo más tarde!"}}}[this.getIdioma()][e][t]}}}]),angular.module("mapsService").service("maps",["$q",function(e){return{getCurrentLocation:function(){var t=e.defer(),o={};return navigator.geolocation||(o.error="Navegador não suporta localização!",t.reject(o)),navigator.geolocation.getCurrentPosition(function(e){o.lat=e.coords.latitude,o.lng=e.coords.longitude,t.resolve(o)},function(e){o.error="Problemas na hora de pegar localização!",t.reject(o)}),t.promise}}}]),angular.module("bandEdi").service("session",["msgsService","$state","dialogService",function(n,a,e){return{setData:function(e,t){try{return sessionStorage.setItem(e,btoa(t)),!0}catch(e){throw e}},getData:function(e){try{if(!sessionStorage.getItem(e))throw n.getMsg("app","5");return atob(sessionStorage.getItem(e))}catch(e){throw n.getMsg("app","5")}},valideSession:function(e){try{if(sessionStorage.getItem("tokenData")){for(var t=JSON.parse(this.getData("configs")),o=!1,r=0;r<t.length;r++)t[r].state==e&&(o=!0);return o||a.go("home"),o}return this.brokedSession(),!1}catch(e){n.getMsg("app","5")}},clear:function(){sessionStorage.clear()},brokedSession:function(){e.alert(n.getMsg("app","5")),sessionStorage.clear(),a.go("initial")}}}]),angular.module("timeService").service("time",[function(){return{StringToNumber:function(e){var t=e.split(":"),o=null==t[2]?null:1*t[2];return{horas:1*t[0],minutos:1*t[1],segundos:o}},numberToString:function(e){e.horas=1*e.horas;var t=""+e.horas;t=1==t.length?"0"+t:t,e.minutos=1*e.minutos;var o=""+e.minutos;o=1==o.length?"0"+o:o;var r=null==e.segundos||null==e.segundos?"":e.segundos;return t+":"+o+(r=1<(r=1==(r=""+(r.length<1?"":1*r)).length?"0"+r:r).length?":"+r:"")},formatCalcDatesResult:function(e){var t=parseInt(60*e*60,10),o=Math.floor(t/3600),r=Math.floor((t-3600*o)/60),n=t-3600*o-60*r;return o<10&&(o="0"+o),r<10&&(r="0"+r),n<10&&(n="0"+n),o+":"+r+":"+n},newDateToIe:function(e){var t=(e=e.split("-"))[2].split(" "),o=t[1].split(":");return e[0]=Math.floor((""+e[0]).replace(/[^0-9]/gi,"")),e[1]=Math.floor((""+e[1]).replace(/[^0-9]/gi,""))-1,t[0]=Math.floor((""+t[0]).replace(/[^0-9]/gi,"")),o[0]=Math.floor((""+o[0]).replace(/[^0-9]/gi,"")),o[1]=Math.floor((""+o[1]).replace(/[^0-9]/gi,"")),[e[0],e[1],t[0],o[0],o[1],0]},secondsToStringMin:function(e){var t=Math.floor(e/60),o=Math.floor(e-60*t);return{minutes:t=t.toString().length<=1?"0"+t:t,seconds:o=o.toString().length<=1?"0"+o:o}},toCurrentYearFrom:function(e){for(var t=(new Date).getFullYear(),o=[];o.push(1*e),++e<=t;);return o}}}]),angular.module("textService").service("text",[function(){return{textFixedSize:function(e,t,o,r){if(e.length>=t)e=e.substr(0,t);else if(1==r)for(var n=e.length;n<t;n++)e=o+e;else for(n=e.length;n<t;n++)e+=o;return e},saveTxtFile:function(e,t){var o=document.createElement("a"),r=new Blob([t],{type:"text/plain"});o.href=URL.createObjectURL(r),o.download=e,setTimeout(function(){o.click()},100)}}}]),angular.module("bandEdi").service("auth",["session","$q","$http","$state","appUrls","msgsService",function(r,t,n,e,a,i){return{login:function(e){var o=t.defer();return n.post(a.getUrl("auth"),e).then(function(e){var t=e.data;r.setData("tokenData",JSON.stringify(t.tokenData)),r.setData("usuario",JSON.stringify(t.usuario)),r.setData("usuarioRh",JSON.stringify(t.usuarioRh)),o.resolve(t)}).catch(function(e){var t=e.data.error;o.reject(i.getMsg(t.module,t.msg))}),o.promise},logout:function(){r.clear(),e.go("initial")}}}]),angular.module("bandEdi").service("dateService",[function(){return{formatDateDB:function(e){return e.toLocaleDateString("pt-BR",{year:"numeric",month:"numeric",day:"numeric"}).replace("BRT","").trim().split("/").reverse().join("-")},formatDateTimeDB:function(e){return e.toLocaleDateString("pt-BR",{timeZone:"America/Sao_Paulo",year:"numeric",month:"numeric",day:"numeric"}).replace("BRT","").trim().split("/").reverse().join("-")+" "+e.toLocaleTimeString("pt-BR",{timeZone:"America/Sao_Paulo",hour:"numeric",minute:"numeric",second:"numeric"}).replace("BRT","").trim()},formatDateHeader:function(e){var t=new Date(e).toLocaleString("pt-br",{month:"long"}),o=e.split("-");return o[2]+" de "+t+" de "+o[0]}}}]),angular.module("bandApiService").service("api",["session","$q","$http","$state","appUrls","msgsService",function(o,n,a,e,i,s){return{post:function(e,t){var o=n.defer();return a.post(i.getUrl(e),t,this.getHeader()).then(function(e){console.log("postResult",e),o.resolve(e)}).catch(function(e){console.log("postError",e);var t=e.data.error;o.reject(s.getMsg(t.module,t.msg))}),o.promise},show:function(e,t){var o=n.defer();return console.log(i.getUrl(e)+"/"+t),a.get(i.getUrl(e)+"/"+t,this.getHeader()).then(function(e){o.resolve(e),console.log("getResult",e)}).catch(function(e){console.log("getError",e);var t=e.data.error;o.reject(s.getMsg(t.module,t.msg))}),o.promise},put:function(e,t,o){var r=n.defer();return console.log(i.getUrl(e)+"/"+o),a.put(i.getUrl(e)+"/"+o,t,this.getHeader()).then(function(e){r.resolve(e),console.log("putResult",e)}).catch(function(e){console.log("putError",e);var t=e.data.error;r.reject(s.getMsg(t.module,t.msg))}),r.promise},getHeader:function(){try{var e=JSON.parse(o.getData("tokenData")),t={"Content-Type":"application/json",Authorization:e.token_type+" "+e.access_token};return console.log(t),t}catch(e){return console.log("getHeaderError",e),{"Content-Type":"application/json"}}}}}]),angular.module("text").directive("reduceDesc",function(){return function(e,t,o){console.log(e,t,o)}}).directive("numbers",function(){return{require:"ngModel",link:function(e,t,o,r){r.$parsers.push(function(e){if(e){var t=e.replace(/[^0-9]/g,"");return t!==e&&(r.$setViewValue(t),r.$render()),t}})}}}).directive("uppercase",function(){return{require:"ngModel",link:function(e,r,t,n){var o=function(e){null==e&&(e="");var t=e.toUpperCase();if(t!==e){var o=r[0].selectionStart;n.$setViewValue(t),n.$render(),r[0].selectionStart=o,r[0].selectionEnd=o}return t};n.$parsers.push(o),o(e[t.ngModel])}}}),angular.module("timeService").directive("hours",function(){return{require:"ngModel",link:function(e,t,o,r){r.$parsers.push(function(o){return document.onkeypress=function(e){var t=8==e.keyCode||46==e.keyCode;2!=o.length||t||(o+=":"),r.$setViewValue(o),r.$render()},o=(o=(o=(o=(o=(o=(o=(o=(o=(o=o.replace(/[^\dh:]/,"")).replace(/^[^0-2]/,"")).replace(/^([2-9])[4-9]/,"$1")).replace(/^\d[:h]/,"")).replace(/^([01][0-9])[^:h]/,"$1")).replace(/^(2[0-3])[^:h]/,"$1")).replace(/^(\d{2}[:h])[^0-5]/,"$1")).replace(/^(\d{2}h)./,"$1")).replace(/^(\d{2}:[0-5])[^0-9]/,"$1")).replace(/^(\d{2}:\d[0-9])./,"$1"),transformedNumber=o,r.$setViewValue(transformedNumber),r.$render(),transformedNumber})}}}),angular.module("bandEdi").filter("capitalize",[function(){return function(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}}]),angular.module("bandEdi").filter("dtBrFormat",[function(){return function(e){if(null!=e&&e.length<=10)return e.split("-").reverse().join("/");if(null!=e&&10<e.length){var t="",o=e.split(" ");return t=o[0].split("-").reverse().join("/"),t+=" "+o[1]}}}]);